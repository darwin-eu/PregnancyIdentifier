<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>PPS algorithm • PregnancyIdentifier</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="PPS algorithm">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">PregnancyIdentifier</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<link href="pps_files/htmltools-fill-0.5.9/fill.css" rel="stylesheet">
<script src="pps_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="pps_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="pps_files/datatables-binding-0.34.0/datatables.js"></script><link href="pps_files/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="pps_files/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="pps_files/dt-core-1.13.6/js/jquery.dataTables.min.js"></script><script src="pps_files/jszip-1.13.6/jszip.min.js"></script><link href="pps_files/dt-ext-buttons-1.13.6/css/buttons.dataTables.min.css" rel="stylesheet">
<script src="pps_files/dt-ext-buttons-1.13.6/js/dataTables.buttons.min.js"></script><script src="pps_files/dt-ext-buttons-1.13.6/js/buttons.html5.min.js"></script><script src="pps_files/dt-ext-buttons-1.13.6/js/buttons.colVis.min.js"></script><script src="pps_files/dt-ext-buttons-1.13.6/js/buttons.print.min.js"></script><link href="pps_files/crosstalk-1.2.2/css/crosstalk.min.css" rel="stylesheet">
<script src="pps_files/crosstalk-1.2.2/js/crosstalk.min.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>PPS algorithm</h1>
            
      

      <div class="d-none name"><code>pps.Rmd</code></div>
    </div>

    
    
<p>The <strong>PPS</strong> (pregnancy-related concept) algorithm builds
pregnancy episodes from <strong>pregnancy-related concepts</strong>
across OMOP domains and their <strong>expected gestational timing
windows</strong>. It is run via <code><a href="../reference/runPps.html">runPps()</a></code> and produces
episode-level outputs that are later merged with HIP episodes by
<code><a href="../reference/mergeHipps.html">mergeHipps()</a></code>. See the <a href="algorithm.html">pipeline
overview</a> and the <a href="merge.html">Merge vignette</a>.</p>
<hr>
<p>Often electronic health records do not contain a clean variable that
identifies pregnancy episode start and end dates.</p>
<p>Instead, we observe scattered clinical signals:</p>
<ul>
<li>“Gestational week 12”</li>
<li>“Second trimester”</li>
<li>“Pregnancy confirmed”</li>
<li>“Prenatal visit”</li>
<li>“Delivery procedure”</li>
</ul>
<p>Each appears on different dates, in different tables, and may be
noisy or incorrect.</p>
<p>The PPS algorithm reconstructs <strong>pregnancy episodes</strong> by
asking “Which of these records plausibly belong to the same
pregnancy?”</p>
<hr>
<div class="section level2">
<h2 id="build-pregnancy-timing-evidence">Build pregnancy timing evidence<a class="anchor" aria-label="anchor" href="#build-pregnancy-timing-evidence"></a>
</h2>
<p>From multiple OMOP tables, PPS extracts only
<strong>pregnancy-related concepts</strong> that indicate gestational
timing, each with:</p>
<ul>
<li><code>person_id</code></li>
<li><code>domain_concept_start_date</code></li>
<li><code>domain_concept_id</code></li>
<li>known gestational timing range:</li>
</ul>
<pre><code>min_month   max_month
---------------------
3           4      ← e.g., second trimester
8           9      ← e.g., late pregnancy
0           1      ← early pregnancy indicator</code></pre>
<p>So for every pregnancy record identified by PPS we know that the
observation usually happens around months X–Y of pregnancy.</p>
<p>You can investigate the PPS concept data below.</p>
<div class="datatables html-widget html-fill-item" id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"data":[["Alpha-1-Fetoprotein [Mass/volume] in Serum or Plasma","Alpha-1-Fetoprotein [Multiple of the median] adjusted in Serum or Plasma","Alpha-1-Fetoprotein [Multiple of the median] in Serum or Plasma","Alpha-1-fetoprotein measurement, serum","Alpha-fetoprotein (AFP); serum","Amniocentesis","Amniocentesis; diagnostic","Antenatal 12 weeks examination","Antenatal 16 week examination","Antenatal 20 week examination","Antenatal 22 week examination","Antenatal 24 week examination","Antenatal 25 week examination","Antenatal 28 week examination","Antenatal 30 week examination","Antenatal 31 week examination","Antenatal 32 week examination","Antenatal 34 week examination","Antenatal 35 week examination","Antenatal 36 week examination","Antenatal 37 week examination","Antenatal 38 week examination","Antenatal 39 week examination","Antenatal 40 week examination","Antenatal 41 week examination","Antenatal 42 week examination","Diagnostic amniocentesis","Diagnostic amniocentesis using ultrasound guidance","Doppler echocardiography, fetal, pulsed wave and/or continuous wave with spectral display; complete","Doppler fetal echocardiography","Echocardiography, fetal, cardiovascular system, real time with image documentation (2D), with or without M-mode recording","Estriol","Estriol (E3).unconjugated [Mass/volume] in Serum or Plasma","False labor at or after 37 completed weeks of gestation","First trimester pregnancy","Gestation period, 5 weeks","Gestation period, 6 weeks","Gestation period, 7 weeks","Gestation less than 9 weeks","Gestation period, 10 weeks","Gestation period, 11 weeks","Gestation period, 12 weeks","Gestation period, 13 weeks","Gestation 9- 13 weeks","Gestation period, 14 weeks","Gestation 14 - 20 weeks","Gestation period, 15 weeks","Gestation period, 16 weeks","Gestation period, 17 weeks","Gestation period, 18 weeks","Gestation period, 19 weeks","Gestation less than 20 weeks","Gestation period, 20 weeks","Gestation period, 21 weeks","Gestation period, 22 weeks","Gestation period, 23 weeks","Gestation period, 24 weeks","Gestation period, 25 weeks","Gestation period, 26 weeks","Gestation period, 27 weeks","Gestation period, 28 weeks","Gestation period, 29 weeks","Gestation period, 30 weeks","Gestation period, 31 weeks","Gestation period, 32 weeks","Gestation period, 33 weeks","Gestation period, 34 weeks","Gestation period, 35 weeks","Gestation period, 36 weeks","Gestation period, 37 weeks","Gestation period, 38 weeks","Gestation period, 39 weeks","Gestation period, 40 weeks","Gestation period, 41 weeks","Gestation period, 42 weeks","Gestation period, 8 weeks","Gestation period, 9 weeks","Group B streptococcus carrier complicating pregnancy","Infectious agent detection by nucleic acid (DNA or RNA); Streptococcus, group B, amplified probe technique","Inhibin [Mass/volume] in Serum or Plasma","Inhibin A","Inhibin A [Multiple of the median] in Serum or Plasma","Neural tube defect risk [Likelihood] in Fetus","Premature 28 week quadruplet","Term pregnancy","Post-term pregnancy","Pregnancy test positive","Urine pregnancy test positive","Second trimester pregnancy","Second trimester quad maternal screen [Interpretation] in Serum or Plasma Narrative","Streptococcus agalactiae [Presence] in Specimen by Organism specific culture","Streptococcus agalactiae [Presence] in Vaginal fluid by Organism specific culture","Streptococcus agalactiae [Presence] in Vag+Rectum by Organism specific culture","Streptococcus agalactiae DNA [Presence] in Specimen by NAA with probe detection","Third trimester pregnancy less than 36 weeks","Trisomy 18 risk [Likelihood] in Fetus","Trisomy 21 risk [Likelihood] in Fetus","Trisomy 21 risk based on maternal age+Pregnancy associated plasma protein A+Choriogonadotropin+Nuchal translucency [Likelihood] in Fetus","Trisomy 18 risk based on maternal age + Pregnancy associated plasma protein A + Choriogonadotropin + Nuchal translucency [Likelihood] in Fetus","Trisomy 18 + Trisomy 13 risk [Likelihood] in Fetus","Fetal Trisomy 18 risk [Likelihood] Based on maternal age","Fetal Trisomy 21 risk [Likelihood] Based on maternal age","Ultrasonic guidance for amniocentesis, imaging supervision and interpretation","Ultrasound, pregnant uterus, real time with image documentation, fetal and maternal evaluation plus detailed fetal anatomic examination, transabdominal approach; single or first gestation","Ultrasound, pregnant uterus, real time with image documentation, fetal and maternal evaluation, first trimester (&lt; 14 weeks 0 days), transabdominal approach; single or first gestation","Ultrasound, pregnant uterus, real time with image documentation, first trimester fetal nuchal translucency measurement, transabdominal or transvaginal approach; single or first gestation","Uncertain viability of pregnancy","First trimester bleeding","Threatened miscarriage in first trimester","Second trimester bleeding","Ultrasonography in second trimester","Ultrasonography of Second Trimester, Single Fetus","Antenatal ultrasound scan 4-8 weeks","Antenatal ultrasound scan at 17-22 weeks","Antenatal ultrasound scan at 22-40 weeks","Antenatal ultrasound scan at 9-16 weeks","Baby premature 24-26 weeks","Baby premature 26-28 weeks","Baby premature 28-32 weeks","Baby premature 32-36 weeks","Baby premature 36 weeks","Double test","Cervical length scanning at 24 weeks"],[3009306,3016670,3024370,4014768,2212198,4146045,2110279,4015296,4014149,4014150,44808979,4015141,44808980,4014433,4014151,44808981,4015297,4015298,4014434,4015299,4015142,4014152,4015300,4015301,4015302,4014435,4143646,40479665,2211763,46273020,2722250,2212323,3025455,4062558,4239938,4290009,4313026,4270513,4322726,4242241,4174506,4197245,4266517,4181468,4248725,4178165,4283690,4049621,4277749,4097608,4181751,4324063,4051642,4185780,4274955,4336226,439922,435640,444023,432430,444461,444417,434484,433864,442558,441678,443874,444267,438543,442355,443871,435655,444098,442769,444067,4132434,4245908,37016152,2213172,3012620,2212802,3035828,3048541,3174212,4336958,432695,4094910,4041878,4244438,3049229,3036000,3020321,43055441,3048882,4180111,3047352,3043238,3050401,36303380,40770418,3052868,3049207,2211785,2211751,2211747,2211753,4084768,3657563,4252252,4327745,40486918,2793349,4061803,4061534,4141415,4060265,4149449,4149457,46271955,46271814,4149451,4078286,44790204],[3.75,3.75,3.75,3.75,3.75,4,4,3,4,5,5.5,6,6.25,7,7.5,7.75,8,8.5,8.75,9,9.25,9.5,9.75,10,10.25,10.5,4,4,4,4,4,3.75,3.75,9,1,1.25,1.5,1.75,1,2.5,2.75,3,3.25,2.25,3.5,3.5,3.75,4,4.25,4.5,4.75,1,5,5.25,5.5,5.75,6,6.25,6.5,6.75,7,7.25,7.5,7.75,8,8.25,8.5,8.75,9,9.25,9.5,9.75,10,10.25,10.5,2,2.25,8,8,3.75,3.75,3.75,3.75,7,9.25,10.5,1,1,3.5,3.75,8,8,8,8,7,2.75,2.75,2.5,2.5,2.5,2.75,2.5,4,4,2,2.75,1,1,1,3.5,3.5,3.5,1,4.25,5.5,2.25,6,6.5,7,7.5,8,2.75,6],[5.5,5.5,5.5,5.5,5.5,7,7,3,4,5,5.5,6,6.25,7,7.5,7.75,8,8.5,8.75,9,9.25,9.5,9.75,10,10.25,10.5,7,7,7,7,7,5.5,5.5,11,4,1.25,1.5,1.75,2,2.5,2.75,3,3.25,3.25,3.5,5,3.75,4,4.25,4.5,4.75,4.75,5,5.25,5.5,5.75,6,6.25,6.5,6.75,7,7.25,7.5,7.75,8,8.25,8.5,8.75,9,9.25,9.5,9.75,10,10.25,10.5,2,2.25,11,11,5.5,5.5,5.5,5.5,7,10.25,11,4,4,6.25,5.5,11,11,11,11,8.75,5.5,5.5,4,4,4,5.5,4,7,6,4,3.5,3,4,4,6.25,6.25,6.25,2,5.5,10,4,6.5,7,7.5,8,8,3.5,6],[1.75,1.75,1.75,1.75,1.75,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,3,3,3,1.75,1.75,2,3,0,0,0,1,0,0,0,0,1,0,1.5,0,0,0,0,0,3.75,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,1.75,1.75,1.75,1.75,0,1,0.5,3,3,2.75,1.75,3,3,3,3,1.75,2.75,2.75,1.5,1.5,1.5,2.75,1.5,3,2,2,0.75,2,3,3,2.75,2.75,2.75,1,1.25,4.5,1.75,0.5,0.5,0.5,0.5,0,0.75,0],[4.625,4.625,4.625,4.625,4.625,5.5,5.5,3,4,5,5.5,6,6.25,7,7.5,7.75,8,8.5,8.75,9,9.25,9.5,9.75,10,10.25,10.5,5.5,5.5,5.5,5.5,5.5,4.625,4.625,10,2.5,1.25,1.5,1.75,1.5,2.5,2.75,3,3.25,2.75,3.5,4.25,3.75,4,4.25,4.5,4.75,2.875,5,5.25,5.5,5.75,6,6.25,6.5,6.75,7,7.25,7.5,7.75,8,8.25,8.5,8.75,9,9.25,9.5,9.75,10,10.25,10.5,2,2.25,9.5,9.5,4.625,4.625,4.625,4.625,7,9.75,10.75,2.5,2.5,4.875,4.625,9.5,9.5,9.5,9.5,7.875,4.125,4.125,3.25,3.25,3.25,4.125,3.25,5.5,5,3,3.125,2,2.5,2.5,4.875,4.875,4.875,1.5,4.875,7.75,3.125,6.25,6.75,7.25,7.75,8,3.125,6]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>pps_concept_name<\/th>\n      <th>pps_concept_id<\/th>\n      <th>pps_min_month<\/th>\n      <th>pps_max_month<\/th>\n      <th>pps_gestational_timespan_months<\/th>\n      <th>pps_gt_month_midpoint<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bfrtip","buttons":["copy","csv","excel"],"pageLength":10,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5]},{"name":"pps_concept_name","targets":0},{"name":"pps_concept_id","targets":1},{"name":"pps_min_month","targets":2},{"name":"pps_max_month","targets":3},{"name":"pps_gestational_timespan_months","targets":4},{"name":"pps_gt_month_midpoint","targets":5}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><hr>
</div>
<div class="section level2">
<h2 id="process-one-person-at-a-time">Process one person at a time<a class="anchor" aria-label="anchor" href="#process-one-person-at-a-time"></a>
</h2>
<p>For each person:</p>
<ol style="list-style-type: decimal">
<li>Sort all pregnancy-related records by date</li>
<li>Walk forward in time</li>
<li>Decide whether each record continues the current pregnancy or starts
a new one</li>
</ol>
<hr>
<p>Core idea: <em>agreement</em>. Two records are said to
<strong>agree</strong> if the <em>observed time difference</em> between
them matches what pregnancy biology would expect.</p>
<hr>
<div class="section level3">
<h3 id="how-agreement-is-computed">How agreement is computed<a class="anchor" aria-label="anchor" href="#how-agreement-is-computed"></a>
</h3>
<p>Suppose we have two records:</p>
<table class="table">
<thead><tr class="header">
<th>Record</th>
<th>Date</th>
<th>Gestational meaning</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>Jan 1</td>
<td>early pregnancy (month 1–2)</td>
</tr>
<tr class="even">
<td>B</td>
<td>May 1</td>
<td>mid pregnancy (month 5–6)</td>
</tr>
</tbody>
</table>
<p>The observed spacing between the two records is</p>
<pre><code>Jan → May ≈ 4 months</code></pre>
<p>The expected spacing for these two reacords based on clinical
knowledge is a range.</p>
<pre><code>min_expected = 5 − 2 = 3 months
max_expected = 6 − 1 = 5 months</code></pre>
<p>With slack (±2 months) we calculate and acceptable window of for the
observed spacing.</p>
<pre><code>acceptable window = 1 to 7 months</code></pre>
<p>Since the observed spacing is 4 months we say these records are in
agreement and are plausibly part of the same pregnancy episode.</p>
<p>If the observed gap falls inside the window → records agree.</p>
<p>Agreement means:</p>
<blockquote>
<p>“These two records could plausibly belong to the same pregnancy.”</p>
</blockquote>
<p>No agreement means:</p>
<blockquote>
<p>“These two records cannot biologically belong to the same
pregnancy.”</p>
</blockquote>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="agreement-is-evaluated-in-two-ways">Agreement is evaluated in two ways<a class="anchor" aria-label="anchor" href="#agreement-is-evaluated-in-two-ways"></a>
</h2>
<div class="section level3">
<h3 id="direct-agreement-primary-rule">Direct agreement (primary rule)<a class="anchor" aria-label="anchor" href="#direct-agreement-primary-rule"></a>
</h3>
<p>When processing record <em>i</em>:</p>
<blockquote>
<p>Does record <em>i</em> agree with <strong>any earlier record</strong>
in the current timeline?</p>
</blockquote>
<p>If yes → stay in same episode.</p>
<pre><code>Pregnancy episode
|--------------------------------|

R1 ----- R2 ----- R3 ----- Ri
             ↑
          agrees?</code></pre>
<p>Only <strong>one match is needed</strong>.</p>
<hr>
</div>
<div class="section level3">
<h3 id="surrounding-agreement-outlier-protection">Surrounding agreement (outlier protection)<a class="anchor" aria-label="anchor" href="#surrounding-agreement-outlier-protection"></a>
</h3>
<p>Sometimes one record is wrong:</p>
<ul>
<li>incorrect date</li>
<li>miscoded concept</li>
<li>late data entry</li>
</ul>
<p>So PPS asks:</p>
<blockquote>
<p>Even if record <em>i</em> doesn’t agree with earlier records, do
records <em>around it</em> agree with each other?</p>
</blockquote>
<pre><code>R1 ----- R2 ---- Ri ---- R4 ----- R5
       |-----------------------|
                agree</code></pre>
<p>If <strong>left and right records agree</strong>, then record
<em>i</em> is treated as noise and kept in the same pregnancy.</p>
<p>This prevents a single bad record from splitting an episode.</p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="when-does-a-new-episode-start">When does a new episode start?<a class="anchor" aria-label="anchor" href="#when-does-a-new-episode-start"></a>
</h2>
<p>A new pregnancy episode begins only if <strong>both timing and
biology indicate it</strong>.</p>
<p>A new episode starts if:</p>
<hr>
<div class="section level3">
<h3 id="rule-1-incompatible-meaningful-gap">Rule 1 — incompatible + meaningful gap<a class="anchor" aria-label="anchor" href="#rule-1-incompatible-meaningful-gap"></a>
</h3>
<pre><code>no agreement AND gap &gt; 1 month</code></pre>
<p>Why?</p>
<ul>
<li>
<p>small gaps (&lt;1 month) often represent:</p>
<ul>
<li>documentation retries</li>
<li>duplicate visits</li>
<li>late coding</li>
</ul>
</li>
<li><p>so PPS waits for a real temporal break</p></li>
</ul>
<hr>
</div>
<div class="section level3">
<h3 id="rule-2-definitely-new-pregnancy">Rule 2 — definitely new pregnancy<a class="anchor" aria-label="anchor" href="#rule-2-definitely-new-pregnancy"></a>
</h3>
<pre><code>gap &gt; 10 months</code></pre>
<p>Regardless of agreement.</p>
<p>Why?</p>
<ul>
<li>A pregnancy cannot last that long</li>
<li>Even with coding noise, this must be a new pregnancy</li>
</ul>
<hr>
<div class="section level4">
<h4 id="decision-diagram">Decision diagram<a class="anchor" aria-label="anchor" href="#decision-diagram"></a>
</h4>
<pre><code>                 New record
                      |
              ┌───────┴────────┐
              |                |
         gap &gt; 10 mo?      no
              |                |
            YES          agreement?
              |                |
         NEW EPISODE     yes → same
                               |
                          no + gap &gt; 1 mo?
                               |
                            yes → new
                            no  → same</code></pre>
<hr>
</div>
</div>
</div>
<div class="section level2">
<h2 id="final-cleanup-remove-implausible-pregnancies">Final cleanup: remove implausible pregnancies<a class="anchor" aria-label="anchor" href="#final-cleanup-remove-implausible-pregnancies"></a>
</h2>
<p>After episodes are assigned:</p>
<ul>
<li>Each episode’s duration is computed</li>
<li>Any episode lasting <strong>&gt; 12 months</strong> is
discarded</li>
</ul>
<p>Why?</p>
<ul>
<li>Normal pregnancy ≈ 9–10 months</li>
<li><ul>
<li>documentation noise</li>
</ul></li>
<li><blockquote>
<p>12 months is biologically implausible</p>
</blockquote></li>
</ul>
<p>These episodes are marked invalid (<code>episode = 0</code>).</p>
<hr>
</div>
<div class="section level2">
<h2 id="final-output">Final output<a class="anchor" aria-label="anchor" href="#final-output"></a>
</h2>
<p>For each person:</p>
<table class="table">
<thead><tr class="header">
<th>person_id</th>
<th>episode</th>
<th>min_date</th>
<th>max_date</th>
<th>concepts</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>1</td>
<td>2019-01-10</td>
<td>2019-10-02</td>
<td>14</td>
</tr>
<tr class="even">
<td>1</td>
<td>2</td>
<td>2021-03-04</td>
<td>2021-12-15</td>
<td>11</td>
</tr>
</tbody>
</table>
<p>Each episode represents a <strong>reconstructed
pregnancy</strong>.</p>
<hr>
</div>
<div class="section level2">
<h2 id="outputs-written-by-runpps">Outputs written by runPps()<a class="anchor" aria-label="anchor" href="#outputs-written-by-runpps"></a>
</h2>
<p><code><a href="../reference/runPps.html">runPps()</a></code> writes the following files to
<code>outputDir</code>:</p>
<ul>
<li>
<strong>pps_episodes.rds</strong> — Always written. PPS episodes
with inferred outcomes (used by <code><a href="../reference/mergeHipps.html">mergeHipps()</a></code> as the PPS
input).</li>
<li>
<strong>pps_gest_timing_episodes.rds</strong> — Only when
<code>debugMode = TRUE</code>. Record-level dataset of pregnancy-related
concept rows with an assigned <code>person_episode_number</code>.</li>
<li>
<strong>pps_min_max_episodes.rds</strong> — Only when
<code>debugMode = TRUE</code>. Episode-level summaries
(<code>pps_episode_min_date</code>, <code>pps_episode_max_date</code>,
<code>pps_episode_max_date_plus_two_months</code>,
<code>n_gt_concepts</code>).</li>
</ul>
<p>For the full pipeline (HIP → PPS → merge → ESD), use
<code><a href="../reference/runPregnancyIdentifier.html">runPregnancyIdentifier()</a></code>; see the <a href="algorithm.html">pipeline overview</a> and the <a href="merge.html">Merge vignette</a>.</p>
<hr>
<p>In summary, the PPS algorithm reconstructs pregnancy episodes by
checking whether the spacing between pregnancy-related clinical records
matches what biology allows, tolerating noise but enforcing
physiological limits.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Aniek Markus, Julieta Politi, Maarten van Kessel, Adam Black.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
